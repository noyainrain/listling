<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <!-- NOTE: Use strict-origin once there is cross-browser support -->
    <meta name="referrer" content="origin" />

    {% raw micro_dependencies() %}
    <link rel="stylesheet" href="{{ static_url('listling.css') }}" />
    <script src="{{ static_url('listling/util.js') }}" defer="defer"></script>
    <script src="{{ static_url('listling/components/list.js') }}" defer="defer"></script>
    <script src="{{ static_url('listling/components/share.js') }}" defer="defer"></script>
    <script src="{{ static_url('listling/components/start.js') }}" defer="defer"></script>
    <script src="{{ static_url('listling/index.js') }}" defer="defer"></script>
</head>

<body is="listling-ui">
    <li class="listling-ui-intro" slot="menu">
        <a class="link" href="/intro"><i class="fa fa-fw fa-rocket"></i> Introduction</a>
    </li>

    {% raw micro_boot() %}

    {% raw micro_templates() %}

    <template class="listling-intro-page-template">
        <div class="listling-intro-intro">
            <h1 class="micro-logo">
                <img data-src="or settings.icon ''" /> <span data-content="settings.title"></span>
            </h1>
            <p class="listling-intro-slogan">Collaborative lists</p>
            <p class="listling-intro-keywords">Free · Simple · No registration required</p>
        </div>

        <div class="listling-intro-intro">
            <ul class="listling-intro-use-cases" data-content="list useCases 'useCase'">
                <template>
                    <li
                        class="micro-quick-nav"
                        data-class-listling-selected="eq useCase selectedUseCase"
                        data-class-listling-intro-no-example="eq useCase.id 'simple'"
                        tabindex="0"
                        data-onmouseenter="focusUseCase"
                        data-onfocus="bind selectUseCase useCase"
                    >
                        <h1>
                            <i data-class-name="format 'fa fa-{icon}' 'icon' useCase.icon"></i>
                            <span data-content="useCase.title"></span>
                        </h1>
                        <div>
                            <button
                                type="button"
                                class="listling-intro-create-list action micro-highlight"
                                title="⌨ S" data-action="new Action createList useCase.id"
                                data-onfocus="bind selectUseCase useCase"
                            >
                                <i class="fa fa-paper-plane"></i> Start
                            </button>
                            <button
                                type="button"
                                class="listling-intro-create-example link micro-highlight"
                                title="⌨ E" data-action="new Action createExample useCase"
                                data-onfocus="bind selectUseCase useCase"
                            >
                                <i class="fa fa-book"></i> View example
                            </button>
                        </div>
                    </li>
                </template>
            </ul>
            <a
                class="listling-intro-missing action micro-small" data-href="settings.feedback_url"
                data-shortcut="new Shortcut 'T'"
            >
                <small>Missing a certain kind of list?</small>
                <i class="fa fa-envelope"></i> Tell us
            </a>
        </div>

        <footer>
            <p><small>Made with <i class="fa fa-heart"></i> in Berlin</small></p>
        </footer>
    </template>
    <style>
        .listling-intro-intro {
            margin: calc(1.5rem * 3) 0;
            text-align: center;
        }

        .listling-intro-intro .micro-logo {
            font-size: 3em;
        }

        .listling-intro-slogan {
            font-size: 2em;
            font-weight: 300;
        }

        .listling-intro-keywords {
            color: var(--micro-color-text-subtle);
        }

        .listling-intro-use-cases {
            display: grid;
            padding: 0;
            grid-template-columns: repeat(auto-fill, calc(14ch * 1.33 + 1.5rem / 2));
            justify-content: center;
            list-style: none;
        }

        .listling-intro-use-cases li {
            padding: 1px;
            border: 1px solid transparent;
            border-radius: calc(1.5rem / 8);
        }

        .listling-intro-use-cases li.listling-selected {
            border-color: var(--micro-color-delimiter);
        }

        .listling-intro-use-cases h1 {
            border: none;
            font-size: 1.33rem;
        }

        .listling-intro-use-cases h1 i {
            display: block;
            font-size: 2rem;
        }

        .listling-intro-use-cases li:not(.listling-selected) div {
            height: 0;
            overflow: hidden;
        }

        .listling-intro-create-list.action.micro-highlight {
            margin: 0 auto;
        }

        .listling-intro-use-cases li.listling-intro-no-example .listling-intro-create-example {
            visibility: hidden;
        }

        listling-intro-page footer {
            text-align: center;
        }

        listling-intro-page footer i {
            color: lightpink;
        }

        [is="listling-ui"]:not(.micro-ui-settings-have-feedback-url) .listling-intro-missing {
            display: none;
        }
    </style>

    <template class="listling-about-page-template">
        <micro-about-page
            short="{title} is a service to make and edit lists collaboratively."
            project-title="Open Listling" project-url="https://github.com/noyainrain/listling"
            project-icon="{{ static_url('images/listling.svg') }}" project-license="AGPL"
            project-license-url="https://www.gnu.org/licenses/agpl.html"
            project-copyright="Copyright © 2020 Open Listling contributors">
        </micro-about-page>
    </template>

    <template class="listling-list-page-template">
        <form>
            <header class="listling-list-title micro-heading micro-panel">
                <h1 class="listling-list-mode-view" data-content="lst.title"></h1>
                <input
                    class="listling-list-mode-edit" name="title" placeholder="List title"
                    required="required" autocomplete="off" data-value="or lst.title ''"
                />
                <button
                    type="button"
                    class="listling-list-create-item-top action listling-list-mode-view micro-interactive"
                    title="Add item (⌨ A)" data-action="new Action startCreateItem"
                >
                    <i class="fa fa-plus-circle"></i>
                </button>
                <div class="listling-list-menu listling-list-mode-view micro-interactive">
                    <button type="button" class="link"><i class="fa fa-bars"></i></button>
                    <micro-contextual class="micro-entity-list">
                        <ul>
                            <li class="listling-list-edit">
                                <button
                                    type="button" class="action micro-contextual-deactivate"
                                    data-action="new Action startEdit"
                                    data-shortcut="new Shortcut 'E'"
                                >
                                    <i class="fa fa-fw fa-pencil-alt"></i> Edit
                                </button>
                            </li>
                            <li>
                                <button
                                    type="button"
                                    class="action micro-contextual-deactivate"
                                    data-action="new Action share lst"
                                    data-shortcut="new Shortcut 'S'"
                                >
                                    <i class="fa fa-fw fa-user-friends"></i> Share
                                </button>
                            </li>
                            <li class="listling-list-subscribe">
                                <button
                                    type="button"
                                    class="action micro-contextual-deactivate"
                                    data-action="new Action subscribeUnsubscribe"
                                    data-shortcut="new Shortcut 'H'"
                                    data-content="switch lst.activity.user_subscribed"
                                >
                                    <template>
                                        <i class="fa fa-fw fa-bell-slash"></i> Unsubscribe
                                    </template>
                                    <template>
                                        <i class="fa fa-fw fa-bell"></i> Subscribe
                                    </template>
                                </button>
                            </li>
                            <li class="listling-list-enter-presentation">
                                <button
                                    type="button" class="link micro-contextual-deactivate"
                                    data-action="new Action presentationEnter"
                                    data-shortcut="new Shortcut 'D'"
                                >
                                    <i class="fa fa-fw fa-chalkboard"></i> Presentation
                                </button>
                            </li>
                        </ul>
                    </micro-contextual>
                </div>
                <button
                    class="action listling-list-mode-edit" data-action="new Action edit"
                    data-shortcut="new Shortcut 'Control+Enter'"
                >
                    <i class="fa fa-check-circle"></i> Done
                </button>
                <div data-content="switch editMode">
                    <template>
                        <button
                            type="button" class="link" data-action="new Action cancelEdit"
                            data-shortcut="new Shortcut 'Escape' 'Cancel'"
                        >
                            <i class="fa fa-times-circle"></i>
                        </button>
                    </template>
                </div>
            </header>

            <div class="listling-list-mode-view" data-content="switch locationEnabled">
                <template>
                    <micro-map data-locations="locations"></micro-map>
                </template>
            </div>

            <p
                class="listling-list-mode-view micro-multiline"
                data-content="markup lst.description"
            ></p>
            <textarea
                name="description" class="listling-list-mode-edit"
                placeholder="Description (optional)" data-value="or lst.description ''"
            ></textarea>

            <div class="listling-list-settings listling-list-mode-edit"
                 data-class-listling-list-settings-expanded="settingsExpanded">
                <button
                    type="button" class="link" title="⌨ C" data-action="new Action toggleSettings"
                >
                    <i class="fa fa-sliders-h"></i> More settings
                </button>
                <section>
                    <header class="micro-heading micro-panel">
                        <h1>Settings</h1>
                        <button
                            type="button" class="link" title="⌨ C" data-action="toggleSettings"
                        >
                            <i class="fa fa-fw fa-search-minus"></i>
                        </button>
                    </header>

                    <label class="micro-block">
                        <input
                            type="checkbox" name="features" value="check"
                            data-checked="includes lst.features 'check'"
                        />
                        Items can be checked
                    </label>

                    <label class="micro-block">
                        <input
                            type="checkbox" name="features" value="assign"
                            data-checked="includes lst.features 'assign'"
                        />
                        Items can be assigned
                    </label>

                    <label class="micro-block">
                        <input
                            type="checkbox" name="features" value="vote"
                            data-checked="includes lst.features 'vote'"
                        />
                        Items can be voted for
                    </label>

                    <label class="micro-block">
                        <input
                            type="checkbox" name="features" value="value"
                            data-checked="valueFeature" data-onchange="onValueFeatureChange"
                        />
                        Items have an associated value
                    </label>

                    <label data-class-micro-disabled="not valueFeature">
                        <small>Value unit (optional)</small>
                        <input
                            name="value-unit" data-disabled="not valueFeature"
                            data-value="lst.value_unit"
                        />
                    </label>

                    <label class="listling-list-features-time micro-block">
                        <input
                            type="checkbox" name="features" value="time"
                            data-checked="includes lst.features 'time'"
                        />
                        Items have a date / time
                    </label>

                    <label class="listling-list-features-location micro-block">
                        <input
                            type="checkbox" name="features" value="location"
                            data-checked="includes lst.features 'location'"
                        />
                        Items have a location
                    </label>

                    <label class="micro-block">
                        <input
                            type="checkbox" name="features" value="play"
                            data-checked="includes lst.features 'play'"
                        />
                        List can be played
                    </label>

                    <label>
                        <small>List mode</small>
                        <input
                            name="mode" readonly="readonly" data-value="modeToText lst.mode"
                            data-value-as-object="lst.mode"
                        />
                        <micro-options data-options="modes" data-to-text="bind modeToText null">
                            <template>
                                <p>
                                    <span data-content="toText option"></span>
                                    <small data-content="switch option 'collaborate' 'view'">
                                        <template>
                                            Users collaborate on the list. They can edit everything.
                                        </template>
                                        <template>
                                            Users view the list. They cannot edit anything.
                                        </template>
                                    </small>
                                </p>
                            </template>
                        </micro-options>
                    </label>

                    <label>
                        <small>Item template (optional)</small>
                        <small>Template for the text of new items.</small>
                        <textarea name="item-template" data-value="or lst.item_template ''">
                        </textarea>
                    </label>
                </section>
            </div>

        </form>

        <ol
            is="micro-ol"
            class="listling-list-items listling-list-mode-view"
            data-onmoveitem="moveItemDrag"
            data-content="list presentItems 'item'"
        >
            <template>
                <li
                    is="listling-item" class="micro-quick-nav" data-item="item" data-list="lst"
                    data-onmove="moveItemKey"
                ></li>
            </template>
        </ol>

        <div
            class="listling-list-create-item listling-list-mode-view micro-interactive"
            data-class-listling-list-creating-item="creatingItem"
        >
            <button
                type="button" class="action micro-highlight"
                data-action="new Action startCreateItem" data-shortcut="new Shortcut 'A'"
            >
                <i class="fa fa-plus-circle"></i> Add item
            </button>
            <li
                is="listling-item" data-list="lst" data-onedit="stopCreateItem"
                data-oncancel="stopCreateItem"
            ></li>
        </div>

        <div class="listling-list-trash listling-list-mode-view micro-interactive"
             data-class-listling-list-trash-expanded="trashExpanded">
            <button
                type="button" class="link micro-small" title="⌨ G"
                data-action="new Action toggleTrash"
            >
                <i class="fa fa-trash"></i>
                <span
                    data-content="formatPlural 'There is one trashed item.' 'There are {n} trashed items.' 'n' trashedItemsCount">
                </span>
            </button>
            <div>
                <header class="micro-heading micro-panel">
                    <h1>Trashed items</h1>
                    <button
                        type="button" class="link" title="Hide (⌨ G)"
                        data-action="new Action toggleTrash"
                    >
                        <i class="fa fa-fw fa-search-minus"></i>
                    </button>
                </header>
                <p class="micro-small">
                    <i class="fa fa-hourglass-half"></i> Trashed items are permanently deleted after
                    7 days.
                </p>
                <ul class="listling-list-trashed-items" data-content="list trashedItems 'item'">
                    <template>
                        <li
                            is="listling-item" class="micro-quick-nav" data-item="item"
                            data-list="lst"
                        ></li>
                    </template>
                </ul>
            </div>
        </div>

        <aside class="listling-list-mode-view micro-interactive">
            <i class="fa fa-user-cog"></i> List by
            <span data-content="list owners.items 'user'">
                <template><span><micro-user data-user="user"></micro-user> </span></template>
            </span>
            · <i class="fa fa-pencil-alt"></i> Edited by
            <span data-content="list lst.authors 'user'">
                <template><span><micro-user data-user="user"></micro-user> </span></template>
            </span>
        </aside>

        <footer class="listling-list-footer" data-onmousedown="presentation.onFooterMouseDown">
            <div class="micro-ui-inside micro-panel">
                <div data-content="switch presentationMode">
                    <template>
                        <button
                            type="button" class="listling-list-previous link"
                            data-action="new Action quickNavigate 'prev'"
                            data-shortcut="new Shortcut 'ArrowUp' 'Previous'"
                        >
                            <i class="fa fa-fw fa-arrow-circle-up"></i>
                        </button>
                    </template>
                </div>
                <button
                    type="button" class="listling-list-play-previous action"
                    data-action="new Action playlistPlayPrevious"
                    data-shortcut="new Shortcut 'B' 'Play previous'"
                >
                    <i class="fa fa-fw fa-step-backward"></i>
                </button>
                <button
                    class="listling-list-play-pause action"
                    data-action="new Action playlistPlayPause"
                    data-shortcut="new Shortcut 'P' 'Play / Pause'"
                >
                    <i
                        class="fa fa-fw" data-class-fa-play="not playlistPlaying"
                        data-class-fa-pause="playlistPlaying"
                    ></i>
                </button>
                <div data-content="switch presentationMode">
                    <template>
                        <button
                            type="button" class="listling-list-next link"
                            data-action="new Action quickNavigate 'next'"
                            data-shortcut="new Shortcut 'ArrowDown' 'Next'"
                        >
                            <i class="fa fa-fw fa-arrow-circle-down"></i>
                        </button>
                    </template>
                </div>
                <button
                    type="button" class="listling-list-play-next action"
                    data-action="new Action playlistPlayNext"
                    data-shortcut="new Shortcut 'F' 'Play next'"
                >
                    <i class="fa fa-fw fa-step-forward"></i>
                </button>
                <p class="micro-panel-main">
                    <span data-content="switch presentationShortURL">
                        <template>
                            Join at <span data-content="presentationShortURL"></span>
                        </template>
                    </span>
                </p>
                <div class="listling-list-exit-presentation" data-content="switch presentationMode">
                    <template>
                        <button
                            type="button" class="link" data-action="new Action presentationExit"
                            data-shortcut="new Shortcut 'Escape' 'Exit'"
                        >
                            <i class="fa fa-times-circle"></i>
                        </button>
                    </template>
                </div>
            </div>
        </footer>
    </template>
    <style>
        .listling-list-scroll-snap {
            scroll-snap-type: block mandatory;
        }

        listling-list-page {
            display: block;
        }

        listling-list-page.listling-list-feature-play {
            padding-bottom: calc(var(--micro-size-m) + 2 * var(--micro-size-s));
        }

        body[noninteractive] listling-list-page {
            /* Ensure that every item can be scrolled to top */
            padding-bottom: 100vh;
        }

        .listling-list-title,
        .listling-list-items [is="listling-item"] {
            scroll-snap-align: start;
        }

        listling-list-page micro-map {
            margin: var(--micro-size-s) 0;
        }

        .listling-list-settings {
            border-top: 1px solid var(--micro-color-delimiter);
        }

        .listling-list-settings label {
            margin: var(--micro-size-s) 0;
        }

        .listling-list-items,
        .listling-list-trashed-items {
            padding: 0;
        }

        .listling-list-trash .micro-heading {
            border: none;
            align-items: baseline
        }

        .listling-list-trash .micro-heading > h1 {
            font-size: 1em;
            font-weight: bold;
            color: #888;
        }

        listling-list-page [is=listling-item],
        .listling-list-create-item > .action,
        .listling-list-trash > .link {
            margin: var(--micro-size-s) 0;
        }

        body[noninteractive] [is="listling-item"] {
            opacity: 0.1;
            filter: blur(1px);
        }

        body[noninteractive] [is="listling-item"]:focus-within {
            box-shadow: none;
            opacity: 1;
            filter: none;
        }

        body[noninteractive] [is="listling-item"]:focus {
            box-shadow: none;
            opacity: 1;
            filter: none;
        }

        .listling-list-footer {
            position: fixed;
            z-index: 2;
            left: 0;
            right: 0;
            bottom: 0;
            box-shadow: 0 0 2px 1px rgba(0, 0, 0, 0.33);
            background: white;
        }

        listling-list-page:not(.listling-list-mode-view) .listling-list-mode-view,
        listling-list-page:not(.listling-list-mode-edit) .listling-list-mode-edit,
        listling-list-page:not(.listling-list-may-modify) .listling-list-create-item-top,
        listling-list-page:not(.listling-list-may-modify) .listling-list-edit,
        body:not(.micro-feature-es6-typed-array) .listling-list-subscribe,
        body:not(.micro-feature-service-workers) .listling-list-subscribe,
        body:not(.micro-feature-push) .listling-list-subscribe,
        body:not(.micro-ui-map-service-enabled) .listling-list-features-location,
        .listling-list-create-item.listling-list-creating-item > .action,
        .listling-list-create-item:not(.listling-list-creating-item) > li,
        listling-list-page:not(.listling-list-has-trashed-items) .listling-list-trash,
        .listling-list-trash.listling-list-trash-expanded > .link,
        .listling-list-trash:not(.listling-list-trash-expanded) > div,
        listling-list-page:not(.listling-list-may-modify) .listling-list-create-item,
        .listling-list-settings.listling-list-settings-expanded > .link,
        .listling-list-settings:not(.listling-list-settings-expanded) > section,
        body:not([noninteractive]) listling-list-page:not(.listling-list-feature-play) > footer,
        listling-list-page.listling-list-feature-play .listling-list-previous,
        listling-list-page.listling-list-feature-play .listling-list-next,
        listling-list-page:not(.listling-list-feature-play) .listling-list-play-previous,
        listling-list-page:not(.listling-list-feature-play) .listling-list-play-pause,
        listling-list-page:not(.listling-list-feature-play) .listling-list-play-next,
        body:not([noninteractive]) .listling-list-exit-presentation {
            display: none;
        }
    </style>

    <template class="listling-item-template">
        <form
            data-class-listling-item-has-value="neq item.value null"
            data-class-listling-item-has-content="hasContent item lst assigneesCount"
            data-class-listling-item-votes-user-voted="votesMeta.user_voted"
            data-class-listling-item-expanded="expanded"
        >
            <header class="micro-panel">
                <div class="micro-ol-handle listling-item-mode-view micro-interactive"
                     title="Move (⌨ Alt + ↑ / Alt + ↓)" tabindex="0">
                </div>

                <button
                    type="button"
                    class="listling-item-vote action listling-item-mode-view"
                    data-action="new Action voteUnvote"
                    data-shortcut="new Shortcut 'V' 'Vote / Unvote'"
                >
                    <i class="fa fa-caret-up"></i>
                </button>
                <div class="listling-item-votes listling-item-mode-view">
                    <p tabindex="0" title="Votes" data-content="votesMeta.count"></p>
                    <micro-contextual data-onactivate="onVotesActivate">
                        <div class="micro-entity-list">
                            <ul data-content="list votes.items 'vote'">
                                <template>
                                    <li class="micro-panel">
                                        <p><micro-user data-user="vote"></micro-user></p>
                                    </li>
                                </template>
                            </ul>
                            <ul>
                                <li class="micro-panel" data-content="switch votesComplete false">
                                    <template>
                                        <button
                                            type="button"
                                            class="listling-item-more-votes link micro-panel-main"
                                            data-action="new Action fetchCollection votes 10"
                                        >
                                            <i class="fa fa-ellipsis-v"></i> More
                                        </button>
                                    </template>
                                </li>
                            </ul>
                        </div>
                    </micro-contextual>
                </div>

                <button
                    type="button"
                    class="listling-item-check action listling-item-mode-view"
                    data-disabled="isCheckDisabled item.trashed lst.mode"
                    data-action="new Action checkUncheck"
                    data-shortcut="new Shortcut 'X' 'Check / Uncheck'"
                >
                    <i
                        data-class-fa="item.checked" data-class-fa-check-square="item.checked"
                        data-class-far="not item.checked" data-class-fa-square="not item.checked"
                    ></i>
                </button>

                <h1
                    class="micro-panel-main listling-item-mode-view"
                    data-content="markup item.title"
                ></h1>
                <input
                    class="micro-panel-main listling-item-mode-edit" name="title"
                    placeholder="Title" required="required" autocomplete="off"
                    data-url-detection="new URLDetection" data-onurlinput="onURLInput"
                />

                <button
                    type="button"
                    class="listling-item-restore action listling-item-mode-view micro-interactive"
                    data-action="new Action restore" data-shortcut="new Shortcut 'R'"
                >
                    <i class="fa fa-trash-restore"></i> Restore
                </button>
                <div class="listling-item-menu listling-item-mode-view micro-interactive">
                    <button type="button" class="link"><i class="fa fa-bars"></i></button>
                    <micro-contextual class="micro-entity-list">
                        <ul>
                            <li class="listling-item-play-pause">
                                <button
                                    type="button" class="action micro-contextual-deactivate"
                                    data-action="new Action playablePlayPause"
                                    data-content="switch playablePlaying" title="⌨ P"
                                >
                                    <template>
                                        <i class="fa fa-fw fa-pause"></i> Pause
                                    </template>
                                    <template>
                                        <i class="fa fa-fw fa-play"></i> Play
                                    </template>
                                </button>
                            </li>
                            <li class="listling-item-edit">
                                <button
                                    type="button"
                                    class="action micro-contextual-deactivate"
                                    data-action="new Action startEdit"
                                    data-shortcut="new Shortcut 'E'"
                                >
                                    <i class="fa fa-fw fa-pencil-alt"></i> Edit
                                </button>
                            </li>
                            <li class="listling-item-assign">
                                <button
                                    type="button"
                                    class="action micro-contextual-deactivate"
                                    data-action="new Action assign" data-shortcut="new Shortcut 'U'"
                                >
                                    <i class="fa fa-fw fa-id-badge"></i> Assign
                                </button>
                            </li>
                            <li class="listling-item-trash">
                                <button
                                    type="button" class="action" data-action="new Action trash"
                                    data-shortcut="new Shortcut 'T'"
                                >
                                    <i class="fa fa-fw fa-trash"></i> Trash
                                </button>
                            </li>
                        </ul>
                    </micro-contextual>
                </div>

                <button
                    class="action listling-item-mode-edit" data-action="new Action edit"
                    data-shortcut="new Shortcut 'Control+Enter'"
                >
                    <i class="fa fa-check-circle"></i> Done
                </button>
                <button
                    type="button" class="link listling-item-mode-edit"
                    data-action="new Action cancelEdit"
                    data-shortcut="new Shortcut 'Escape' 'Cancel'"
                >
                    <i class="fa fa-times-circle"></i>
                </button>
            </header>

            <div class="listling-item-content">
                <dl class="listling-item-meta">
                    <dt class="listling-item-value" title="Value">
                        <i class="fa fa-calculator"></i>
                    </dt>
                    <dd class="micro-panel">
                        <p class="micro-panel-main listling-item-mode-view">
                            <span data-content="item.value"></span>
                            <span data-content="lst.value_unit"><span>
                        </p>
                        <input
                            class="micro-panel-main listling-item-mode-edit" name="value"
                            type="number" step="any" placeholder="Value"
                        />
                        <p class="listling-item-mode-edit" data-content="lst.value_unit"></p>
                    </dd>
                    <dt class="listling-item-time" title="Date / Time">
                        <i class="fa fa-calendar-alt"></i>
                    </dt>
                    <dd>
                        <p class="listling-item-mode-view">
                            <time
                                data-date-time="item.time"
                                data-content="formatTime item.time SHORT_DAY_FORMAT SHORT_CLOCK_FORMAT"
                            ></time>
                        </p>
                        <micro-datetime-input class="listling-item-mode-edit">
                        </micro-datetime-input>
                    </dd>
                    <dt class="listling-item-location" title="Location">
                        <i class="fa fa-map-marker-alt"></i>
                    </dt>
                    <dd>
                        <a
                            class="link listling-item-mode-view" data-href="makeItemURL item true"
                            data-content="item.location.name"
                        ></a>
                        <p class="listling-item-mode-view" data-content="item.location.name"></p>
                        <micro-location-input
                            class="listling-item-mode-edit" name="location" placeholder="Location"
                        >
                        </micro-location-input>
                    </dd>
                </dl>

                <p
                    class="listling-item-assignees listling-item-mode-view"
                    data-content="list assignees 'assignee'"
                >
                    <template>
                        <span><micro-user data-user="assignee"></micro-user> </span>
                    </template>
                </p>

                <!-- Do not switch because micro-video (iframe) resets state when detached -->
                <div
                    class="listling-item-resource micro-block listling-item-mode-view"
                    data-content="resourceElem"
                >
                </div>
                <p
                    class="listling-item-text listling-item-mode-view micro-multiline"
                    data-content="markup item.text"
                ></p>
                <div data-content="switch editMode">
                    <template>
                        <micro-content-input placeholder="Text"></micro-content-input>
                    </template>
                </div>
            </div>

            <footer class="listling-item-footer micro-small listling-item-mode-view">
                <i class="fa fa-user-cog"></i> Item by
                <micro-user data-user="item.authors.0"></micro-user> ·
                <i class="fa fa-pencil-alt"></i> Edited by
                <span data-content="join item.authors 'user'">
                    <template><micro-user data-user="user"></micro-user></template>
                </span>
            </footer>
        </form>
    </template>
    <style>
        [is=listling-item] {
            border: 1px solid var(--micro-color-delimiter);
            border-radius: var(--micro-size-xs);
            list-style: none;
            cursor: pointer;
        }

        [is=listling-item].listling-item-trashed {
            color: #888;
        }

        [is=listling-item] > form {
            position: relative;
            --listling-item-progress: 0%;
            --micro-link-max-height: calc((70ch - 2 * var(--micro-size-s)) * 9 / 16);
            --micro-image-max-height: var(--micro-link-max-height);
        }

        [is=listling-item] > form::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: var(--micro-size-xs);
            border-radius: var(--micro-size-xs) var(--micro-size-xs) 0 0;
            background: var(--micro-color-primary) content-box;
            padding-right: calc(100% - var(--listling-item-progress));
        }

        [is=listling-item] header {
            margin: 0;
        }

        [is=listling-item] .micro-ol-handle {
            padding: var(--micro-size-s);
            min-width: calc(var(--micro-size-m) / 2 + 2 * var(--micro-size-s));
            height: calc(var(--micro-size-m) + 2 * var(--micro-size-s));
            background:
                radial-gradient(circle closest-side, #888 0%, #888 50%, transparent 50%) content-box
                    0 0 / calc(1.5rem / 4) calc(1.5rem / 4);
        }

        [is=listling-item] .micro-panel > .micro-ol-handle:focus,
        [is=listling-item] .micro-panel > .micro-ol-handle:not(:disabled):hover {
            background:
                radial-gradient(circle closest-side, #888 0%, #888 50%, transparent 50%) content-box
                    0 0 / calc(1.5rem / 4) calc(1.5rem / 4),
                var(--micro-color-delimiter);
        }

        listling-list-page:not(.listling-list-feature-vote) .listling-item-vote,
        listling-list-page:not(.listling-list-feature-vote) .listling-item-votes {
            display: none;
        }

        .listling-item-vote i {
            width: 1rem;
            color: var(--micro-color-text-subtle);
            text-align: center;
            transform: scale(1.6);
        }

        [is=listling-item] > form.listling-item-votes-user-voted .listling-item-vote i {
            color: forestgreen;
        }

        .listling-item-votes micro-contextual {
            right: auto;
        }

        .listling-item-check i {
            color: var(--micro-color-border);
        }

        [is=listling-item].listling-item-checked:not(.listling-item-trashed) .micro-panel > .listling-item-check i {
            color: forestgreen;
        }

        [is=listling-item] h1,
        [is=listling-item] h1 + input {
            font-weight: bold;
        }

        [is=listling-item] h1 {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        [is=listling-item] > form.listling-item-expanded h1 {
            white-space: normal;
        }

        [is=listling-item].listling-item-trashed h1 {
            color: inherit;
        }

        listling-list-page:not(.listling-list-feature-assign) .listling-item-assign,
        [is=listling-item]:not(.listling-item-may-modify) .listling-item-assign {
            display: none;
        }

        .listling-item-content {
            border-top: 1px solid var(--micro-color-delimiter);
        }

        [is=listling-item].listling-item-mode-view > form:not(.listling-item-has-content) .listling-item-content {
            display: none;
        }

        .listling-item-meta {
            padding: 0;
            column-gap: 0;
        }

        [is=listling-item].listling-item-mode-edit .listling-item-meta dt,
        [is=listling-item].listling-item-mode-edit .listling-item-meta dd {
            border-bottom: 1px solid var(--micro-color-delimiter);
        }

        .listling-item-meta > dt {
            padding: var(--micro-size-s);
        }

        listling-list-page:not(.listling-list-feature-value) .listling-item-value,
        listling-list-page:not(.listling-list-feature-value) .listling-item-value + dd,
        [is=listling-item].listling-item-mode-view > form:not(.listling-item-has-value) .listling-item-value,
        [is=listling-item].listling-item-mode-view > form:not(.listling-item-has-value) .listling-item-value + dd {
            display: none;
        }

        listling-list-page:not(.listling-list-feature-time) .listling-item-time,
        listling-list-page:not(.listling-list-feature-time) .listling-item-time + dd,
        [is=listling-item].listling-item-mode-view:not(.listling-item-has-time) .listling-item-time,
        [is=listling-item].listling-item-mode-view:not(.listling-item-has-time) .listling-item-time + dd {
            display: none;
        }

        body:not(.micro-ui-map-service-enabled) .listling-item-location,
        body:not(.micro-ui-map-service-enabled) .listling-item-location + dd,
        listling-list-page:not(.listling-list-feature-location) .listling-item-location,
        listling-list-page:not(.listling-list-feature-location) .listling-item-location + dd,
        [is=listling-item].listling-item-mode-view:not(.listling-item-has-location) .listling-item-location,
        [is=listling-item].listling-item-mode-view:not(.listling-item-has-location) .listling-item-location + dd {
            display: none;
        }

        .listling-item-resource > *,
        [is=listling-item] .micro-content-input-resource-wrapper,
        [is=listling-item] .micro-content-input-resource > * {
            display: block;
            width: auto;
        }

        .listling-item-footer {
            padding: var(--micro-size-s);
            border-top: 1px solid var(--micro-color-delimiter);
        }

        [is=listling-item] > form:not(.listling-item-expanded) .listling-item-footer {
            display: none;
        }

        [is=listling-item]:not(.listling-item-mode-view) .listling-item-mode-view,
        [is=listling-item]:not(.listling-item-mode-edit) .listling-item-mode-edit,
        [is=listling-item].listling-item-trashed .micro-ol-handle,
        listling-list-page:not(.listling-list-may-modify) .micro-ol-handle,
        listling-list-page:not(.listling-list-feature-check) .listling-item-check,
        listling-list-page:not(.listling-list-feature-check) .listling-item-uncheck,
        listling-list-page:not(.listling-list-feature-play) [is=listling-item]:not(.listling-item-may-modify) .listling-item-menu,
        [is=listling-item]:not(.listling-item-trashed) .listling-item-restore,
        [is=listling-item]:not(.listling-item-may-modify) .listling-item-restore,
        listling-list-page:not(.listling-list-feature-play) .listling-item-play-pause,
        [is=listling-item]:not(.listling-item-may-modify) .listling-item-edit,
        [is=listling-item]:not(.listling-item-may-modify) .listling-item-trash,
        [is=listling-item].listling-item-trashed .listling-item-menu,
        [is=listling-item].listling-item-has-location-coords .listling-item-location + dd p,
        [is=listling-item]:not(.listling-item-has-location-coords) .listling-item-location + dd .link {
            display: none;
        }
    </style>

    <template class="listling-create-list-event-template">
        <a class="link" data-href="makeListURL event.detail.lst"
           data-content="event.detail.lst.title">
        </a>
        was created by <micro-user data-user="event.user"></micro-user>
    </template>

    {% include 'listling/components/list.html' %}
    {% include 'listling/components/share.html' %}
    {% include 'listling/components/start.html' %}
</body>
